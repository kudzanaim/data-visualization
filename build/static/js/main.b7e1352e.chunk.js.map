{"version":3,"sources":["components/home/charts.jsx","components/home/tables.jsx","components/home/useResize.jsx","components/home/map.jsx","components/home/home.jsx","components/App.js","components/actions/action.jsx","components/store/store.js","components/reducer/reducer.jsx","index.js"],"names":["Charts","props","useState","keys","values","State","setState","useEffect","window","poi","data","map","a","i","newValues","Object","t","shift","b","parseFloat","unshift","style","margin","paddingTop","className","width","height","chartType","loader","options","chart","title","subtitle","Tables","includeScore","async","unsortedValues","numFormat","x","toString","replace","background","color","border","onChange","e","$","removeClass","text","target","value","result","Fuse","search","resultt","addClass","type","placeholder","aria-label","scope","fontSize","borderTop","data-value","toFixed","useResizeObserver","ref","dimensions","setDimensions","observeTarget","current","resizeObserver","ResizeObserver","entries","forEach","entry","contentRect","observe","unobserve","Map","svgRef","useRef","wrapperRef","undefined","pop","fetch","then","r","json","svg","d3","getBoundingClientRect","projection","fitSize","pathGenarator","minProp","features","feature","maxProp","colorScale","domain","range","tooltip","append","selectAll","join","attr","parseInt","properties","on","html","pageY","pageX","poi_data","POI","enter","d","name","lon","lat","clicks","impressions","revenue","id","Home","document","App","exact","path","render","Component","connect","state","dispatch","get","payload","middleware","thunk","withExtraArgument","DB","Store","createStore","action","applyMiddleware","ReactDOM","store","getElementById"],"mappings":"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","file":"static/js/main.b7e1352e.chunk.js","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport {Chart} from 'react-google-charts';\r\n\r\nexport const Charts = ({props})=>{\r\n\r\n    const [State, setState] = useState({keys:null, values:null });\r\n\r\n    useEffect(()=>{\r\n        // Break Down API data:\r\n        window.poi = props.data.poi;\r\n        let keys = props.data.poi.map((a,i)=>{return a['name']});\r\n        let unsortedValues = props.data.poi.map((a,i)=>{ return Object.values(a) });\r\n        let values = unsortedValues.map((a)=>{var t = a; t.shift();t.shift();t.shift(); return t});\r\n\r\n        let newValues = values.map((a)=>{   var t = a.map((b)=>{return parseFloat(b)});  return t   });\r\n        \r\n        // Push POI name to start of array:\r\n        keys.map((a,i)=>{newValues[i].unshift(a)});\r\n\r\n        setState({...State, keys, values:[\r\n            ['', 'Clicks', 'Impressions (x10)', 'Revenue'],\r\n            ...newValues\r\n        ]})\r\n    }, [])\r\n   \r\n    return (\r\n        <div style={{ margin: '0 auto', paddingTop:'10px'}}>\r\n            <div className=\"header\">Data Table</div>\r\n            <div className=\"hp\">Implemented using Google Charts Package, metrics retrieved from Postgres API</div>\r\n            {\r\n                ( State.values )?<Chart className='ChartOne' width={'900px'} height={'400px'} chartType=\"Bar\" loader={<div className=\"loadtxt2\">Loading Chart...</div>} data={ State.values }\r\n                    options={{\r\n                        // Material design options\r\n                        chart: {\r\n                        title: 'Total POI Metrics',\r\n                        subtitle: 'Clicks, Impressions and Revenue',\r\n                        },\r\n                    }}\r\n                    // For tests\r\n                /> : <div className=\"loadtxt\"></div>\r\n            }\r\n        </div>\r\n    )\r\n}","import React, {useEffect, useState} from 'react';\r\nimport Fuse from 'fuse.js';\r\nimport $ from 'jquery';\r\n\r\nexport const Tables = ({props})=>{\r\n\r\n    const [State, setState] = useState({keys:null, values:null}); \r\n\r\n    const options = {\r\n        includeScore: true,\r\n        keys: ['clicks', 'impressions', 'revenue', 'name']\r\n    }\r\n\r\n    useEffect(async()=>{\r\n        // Break Down API data:\r\n        let keys = props.data.poi.map((a,i)=>{return a['name']});\r\n        let unsortedValues = props.data.poi.map((a,i)=>{ return Object.values(a) });\r\n        let values = unsortedValues.map((a)=>{var t = a; t.shift();t.shift();t.shift(); return t});\r\n        let newValues = values.map((a)=>{   var t = a.map( b=> parseFloat(b) );  return t   });\r\n        \r\n        // Push POI name to start of array:\r\n        keys.map((a,i)=>{newValues[i].unshift(a)});\r\n        \r\n        setState({...State, values:[...newValues], keys: ['POI Name', 'Clicks', 'Impressions (x10)', 'Revenue'],});\r\n\r\n    }, []);\r\n\r\n    // Format String:\r\n    const numFormat = (x)=>{\r\n        return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n    };\r\n\r\n    // On Search:\r\n    const search = (e)=>{\r\n\r\n        // Clear highlight\r\n        $('.tditm').removeClass('tbhiglight')\r\n\r\n        const text = $(e.target)[0].value;\r\n        const fuse = new Fuse(props.data.poi, options);\r\n        const result = fuse.search(text);\r\n\r\n        \r\n        // Map Results and Highlight\r\n        window.resultt = result;\r\n\r\n        result.map((a)=>{\r\n            Object.values(a['item']).map((b,i)=>{\r\n                var t = $(`.tditm[data-value=\"${b}\"]`);\r\n                try{\r\n                    if(t){ t.addClass('tbhiglight') }\r\n                }catch(e){return false}\r\n            })\r\n        });\r\n        \r\n    };\r\n\r\n    return (\r\n        <div>\r\n            {/* <div className=\"header\">Fuzzy Search Table</div>\r\n            <div className=\"hp\">Highlights matching rows and uses 3rd party fuzzy-search NPM package </div> */}\r\n            {\r\n                (State.values)?\r\n                <div>\r\n                    <nav style={{ background: '#212529',  margin: '0 auto'}} className=\"navbar navbar-light\">\r\n                        <form className=\"form-inline w-100\">\r\n                            <input style={{background: '#0e1012',color: 'white',border: 'solid 1px #454b52'}} onChange={(e)=>search(e)} className=\"form-control mr-m-2 w-100\" type=\"search\" placeholder=\"Search\" aria-label=\"Search\" />\r\n                        </form>\r\n                    </nav>\r\n        \r\n                    {\r\n                        (State.values)? <table style={{background: 'rgb(33, 37, 41)',color: 'white'}} className=\"table\">\r\n                                <thead className=\"thead-dark\">\r\n                                    {\r\n                                        <tr>\r\n                                            <th scope=\"col\">{ State.keys[0] }</th>\r\n                                            <th scope=\"col\">{ State.keys[1] }</th>\r\n                                            <th scope=\"col\">{ State.keys[2] }</th>\r\n                                            <th scope=\"col\">{ State.keys[3] }</th>\r\n                                        </tr>\r\n                                    }\r\n                                </thead>\r\n                                <tbody>\r\n                                    {\r\n                                        (State.values)? State.values.map((a,i)=>{\r\n                                    \r\n                                            return <tr>\r\n                                                <td style={{ fontSize: '13px', color: '#cccbcb', borderTop: '1px solid #333538'}} className=\"tditem\" ><div className=\"tditm\" data-value={a[0]}> {a[0]}</div></td>\r\n                                                <td style={{ fontSize: '13px', color: '#cccbcb', borderTop: '1px solid #333538'}} className=\"tditem\" ><div className=\"tditm\" data-value={a[1]}> {numFormat( a[1] )}</div></td>\r\n                                                <td style={{ fontSize: '13px', color: '#cccbcb', borderTop: '1px solid #333538'}} className=\"tditem\" ><div className=\"tditm\" data-value={a[2]}> {numFormat( a[2] )}</div></td>\r\n                                                <td style={{ fontSize: '13px', color: '#cccbcb', borderTop: '1px solid #333538'}} className=\"tditem\" ><div className=\"tditm\" data-value={a[3]}> ${numFormat( a[3].toFixed(2) )}</div></td>\r\n                                            </tr>\r\n                                        }): \r\n                                        <tr>\r\n                                            <th scope=\"row\">...</th><td>...</td><td>...</td><td>...</td>\r\n                                        </tr>\r\n                                    }\r\n                                </tbody>\r\n                            </table> : <div>Loading Table</div>\r\n                    }\r\n                </div>\r\n                :\r\n                <div className=\"loadtxt2\">Table Data Loading...</div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\n","import { useEffect, useState } from \"react\";\r\nimport ResizeObserver from \"resize-observer-polyfill\";\r\n\r\n/**\r\n * Hook, that returns the current dimensions of an HTML element.\r\n * Doesn't play well with SVG.\r\n */\r\n\r\nconst useResizeObserver = ref => {\r\n  const [dimensions, setDimensions] = useState(null);\r\n  useEffect(() => {\r\n    const observeTarget = ref.current;\r\n    const resizeObserver = new ResizeObserver(entries => {\r\n      entries.forEach(entry => {\r\n        setDimensions(entry.contentRect);\r\n      });\r\n    });\r\n    resizeObserver.observe(observeTarget);\r\n    return () => {\r\n      resizeObserver.unobserve(observeTarget);\r\n    };\r\n  }, [ref]);\r\n  return dimensions;\r\n};\r\n\r\nexport default useResizeObserver;","import React, {useEffect, useState, useRef} from 'react';\r\nimport * as d3 from \"d3\";\r\nimport * as topojson from \"topojson-client\";\r\nimport fetch from 'node-fetch';\r\nimport useResizeObserver from \"./useResize\";\r\n\r\n\r\nexport const Map = ({props})=>{\r\n    // Ref:\r\n    const svgRef = useRef();\r\n    const wrapperRef = useRef();\r\n    const dimensions = useResizeObserver(wrapperRef);\r\n    \r\n\r\n    // State Decl:\r\n    const [State, setState] = useState({keys:undefined, values:undefined });\r\n    \r\n    // Call Data on DOM Mount:\r\n    useEffect(()=>{\r\n        // Break Down API data:\r\n        let keys = props.data.poi.map((a,i)=>{return a['name']});\r\n        let unsortedValues = props.data.poi.map((a,i)=>{ return Object.values(a) });\r\n        let values = unsortedValues.map((a)=>{var t = a; t.pop(); return t});\r\n\r\n        let newValues = values.map((a)=>{   var t = a.map((b)=>{return parseFloat(b)});  return t   });\r\n        \r\n        // Push POI name to start of array:\r\n        keys.map((a,i)=>{newValues[i].unshift(a)});\r\n\r\n        setState({...State, keys, values:[\r\n            ['', 'Clicks', 'Impressions (x10)', 'Revenue'],\r\n            ...newValues\r\n        ]})\r\n    }, [])\r\n\r\n \r\n    if(State.values){\r\n        fetch(\"https://work-gcsusetqgq-uk.a.run.app/geojson\").then(r=>r.json()).then((data)=>{\r\n            // SVG instantiate and MAP setup:\r\n            const svg = d3.select(svgRef.current);\r\n            const {width} = dimensions || wrapperRef.current.getBoundingClientRect();;\r\n            const height = 600;\r\n            const projection = d3.geoMercator().fitSize([width, height], data);\r\n            const pathGenarator = d3.geoPath().projection(projection);\r\n\r\n            // Set ColorScale, Range & Domain:\r\n            const minProp = d3.min(data.features, (feature) => { return feature[\"id\"]});\r\n            const maxProp = d3.max(data.features, (feature) => {return feature[\"id\"]});\r\n            const colorScale = d3.scaleLinear().domain([minProp, maxProp]).range([\"rgb(246, 31, 81)\", \"rgb(181, 25, 61)\"]);\r\n\r\n            // Map Tooltip:\r\n            let tooltip = d3.select(\"body\").append(\"div\").style(\"position\", \"absolute\").style(\"z-index\", \"10\").style(\"visibility\", \"hidden\").style(\"width\",\"200px\");\r\n\r\n            // Create Map:\r\n            const g = svg.selectAll('.division');\r\n\r\n            g.data(data.features).join(\"path\")\r\n                .attr(\"class\", \"division\")\r\n                .attr(\"fill\", feature=>{return colorScale( parseInt(feature[\"id\"]) )})\r\n                .attr(\"stroke\",\"rgb(246, 31, 81)\")\r\n                .attr(\"data-title\", feature=>feature.properties[\"CDNAME\"])\r\n                .attr(\"d\", feature => pathGenarator(feature))\r\n                \r\n                .on(\"mouseover\", (feature)=> tooltip\r\n                    .style(\"visibility\", \"visible\")\r\n                    .html(`<div>${feature.properties[\"CDNAME\"]}</div>`)\r\n                    .style(\"color\", \"white\") \r\n                    .style(\"cursor\", \"pointer\")\r\n                    .style(\"background\", \"none\")\r\n                    .style(\"font-family\", \"monospace\")\r\n                    .style(\"font-size\", \"20px\")\r\n                )\r\n                .on(\"mousemove\", ()=> (tooltip.style(\"top\", (d3.event.pageY-10)+\"px\").style(\"left\",(d3.event.pageX+10)+\"px\")))\r\n                .on(\"mouseout\", ()=> tooltip.style(\"visibility\", \"hidden\") )\r\n\r\n\r\n            // Get Data from API and Map Vizualizations:\r\n            fetch(\"https://work-gcsusetqgq-uk.a.run.app/poi\").then(r=>r.json()).then((poi_data)=>{\r\n                const POI = poi_data;\r\n\r\n                svg.selectAll(\".pin\")\r\n                    .data(POI)\r\n                    .enter().append(\"circle\", \".pin\")\r\n                    .attr(\"r\", 5)\r\n                    .attr(\"fill\", \"white\")\r\n                    .attr(\"transform\", (d) => {\r\n                        if(d.name == 'CN Tower'){\r\n                            return \"translate(\" + projection([ (d.lon+1), (d.lat) ]) + \")\"\r\n                        }\r\n                        else if(d.name==\"EQ Works\"){\r\n                            return \"translate(\" + projection([ (d.lon-0.2), (d.lat) ]) + \")\"\r\n                        }\r\n                        else{\r\n                            return \"translate(\" + projection([ (d.lon), (d.lat-0.3) ]) + \")\"\r\n                        }\r\n                    })\r\n                    .on(\"mouseover\", (d)=> tooltip\r\n                        .style(\"visibility\", \"visible\")\r\n                        .html(`\r\n                            <div>\r\n                                <div>Location: ${ d.name }</div>\r\n                                <div>Clicks: ${ d.clicks }</div>\r\n                                <div>Impressions: ${ d.impressions }</div>\r\n                                <div>Revenue: $${ d.revenue }</div>\r\n                            </div>\r\n                        `)\r\n                        .style(\"color\", \"white\")\r\n                        .style(\"background\", \"rgb(33, 37, 41)\")\r\n                        .style(\"font-family\", \"monospace\")\r\n                        .style(\"font-size\", \"12px\")\r\n                        .style(\"padding\", \"5px\")\r\n                    )\r\n                    .on(\"mousemove\", function(){return tooltip.style(\"top\", (d3.event.pageY-10)+\"px\").style(\"left\",(d3.event.pageX+10)+\"px\");})\r\n                    .on(\"mouseout\", function(){return tooltip.style(\"visibility\", \"hidden\");});\r\n\r\n                var path= d3.geoPath().projection(projection);\r\n    \r\n            })\r\n        }) \r\n    }\r\n       \r\n    return (\r\n        <div ref={wrapperRef}>\r\n            <div className=\"header\">Map implemeted using D3 JS</div>\r\n            <div className=\"hp\">Hover over white markers for location specific metrics.</div>\r\n            <svg id=\"map\" ref={svgRef}></svg>\r\n        </div>\r\n    )\r\n}","\r\nimport React, {useEffect} from 'react';\r\nimport {Charts} from './charts';\r\nimport {Tables} from './tables';\r\nimport {Map} from './map';\r\nimport _ from 'lodash';\r\n\r\nexport const Home = ({props})=>{\r\n\r\n    document.title = 'EQ Works | Data Visualization Project';\r\n\r\n    useEffect(()=>{\r\n        props.poi();\r\n    }, [])\r\n\r\n    return (\r\n        <div>\r\n            {\r\n                (props.data.poi)?\r\n                <div>\r\n                    <Charts  props={props} />\r\n                    <Tables  props={props} />\r\n                    <Map  props={props} />\r\n                </div>\r\n                :\r\n                <div className=\"loadtxt\" >Fetching Data...</div>\r\n            }\r\n        </div>\r\n    )\r\n}","import React, { Component } from 'react';\nimport {connect} from 'react-redux';\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\nimport {poi} from './actions/action';\nimport './App.css';\n\nimport {Home} from './home/home';\n\n\nexport class App extends Component{\n\n  render(){\n    return (\n      <div className=\"App\">\n          <Router>             \n            <Switch>\n              <Route exact path=\"/\" render={()=><Home props={this.props}/>}/>\n            </Switch>\n          </Router>\n      </div>\n    )\n  }\n}\n\n\n\nconst mapStateToProps = state => ({\n  poi: state.poi,\n  data: state.data,\n})\n\nconst mapActionsToState = dispatch =>({\n  poi: ()=>dispatch(   poi()    ),\n})\n\nexport default connect( mapStateToProps, mapActionsToState )(App);","import $ from 'jquery';\r\nimport _ from 'lodash';\r\n\r\n// Action Types\r\nexport const POI = \"POI\";\r\n\r\n// Get POI Functions\r\nexport function poi(details) {\r\n    return async function(dispatch){\r\n        await $.get(`https://work-gcsusetqgq-uk.a.run.app/poi`, function(data){\r\n            dispatch({\r\n                type: POI,\r\n                payload:{\r\n                    data:data,\r\n                },\r\n            })\r\n        })\r\n        \r\n    }\r\n};","import { createStore, applyMiddleware} from \"redux\";\r\nimport thunk from 'redux-thunk';\r\nimport { reducerFunc } from \"./../reducer/reducer\";\r\n\r\n\r\n// Inital State\r\nconst initialState = {\r\n    data:{poi:null}\r\n};\r\n\r\n\r\n// Middleware\r\nconst middleware = [thunk.withExtraArgument({DB:null})];\r\n\r\nexport const Store = createStore(reducerFunc, initialState, applyMiddleware(...middleware));","import { POI } from \"../actions/action\";\r\n\r\nexport function reducerFunc(state, action) {\r\n  switch (action.type) {\r\n      \r\n      case POI:\r\n         \r\n          return { ...state, data: {poi: action.payload.data} }\r\n\r\n      default:\r\n          return state;\r\n  }\r\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './components/App.css';\nimport { Provider } from \"react-redux\";\nimport App from './components/App';\nimport { Store } from \"./components/store/store\";\n\n\n// ReactDOM.render(<Provider store={store}><App /></Provider>, document.getElementById('root'));\nReactDOM.render( <Provider store={ Store }><App /></Provider>, document.getElementById('root'));\n"],"sourceRoot":""}